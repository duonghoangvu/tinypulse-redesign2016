<!DOCTYPE html>
<head>
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <meta name="viewport" content="maximum-scale=1,width=device-width,initial-scale=1,user-scalable=0"> 
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="css/perform-demo.css" />
</head>
<body class="nav-panel-opened">
  <div class="main-wrapper">
    <header>
      <div class="container">
        <div class="logo">
          <img src="https://www.tinypulse.com/hubfs/redesign_2016/engage_logo.png" />
        </div> 
      </div>
    </header> 
    <div class="content-wrapper">
      <nav>
        <ul class="nav" id="side-menu">
          <li>
            <a href="#">
              <i class="icon icon-speed"></i> <span class="nav-label">Dashboard</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li class="active">
            <a href="#">
              <i class="icon icon-goal"></i> <span class="nav-label">Goals</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li>
            <a href="#">
              <i class="icon icon-arrow-up"></i> <span class="nav-label">Rate</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li>
            <a href="#">
              <i class="icon icon-chrome"></i> <span class="nav-label">360</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li>
            <a href="#">
              <i class="icon icon-snapshot"></i> <span class="nav-label">Reporting</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li>
            <a href="#">
              <i class="icon icon-setting"></i> <span class="nav-label">Settings</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li>
            <a href="#">
              <i class="icon icon-help-circled"></i> <span class="nav-label">Help Center</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
        </ul>
      </nav>
      <div class="main-content">
        <div class="container-fluid">
          <div class="row top-img">
            <div class="col-xs-12 col-md-8 pd-lr-11 mg-b-15">
              <img src="images/perform-demo/top-vertical-nav.png" />
            </div>
          </div>
        </div>
        <div class="container-fluid top-menu">
          <div class="btn-group pull-left">
            <button class="btn btn-flat-gray dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span>Active</span>
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li>
                <a href="#">Active</a>
              </li>
              <li>
                <a href="#">Archived</a>
              </li>
              <li>
                <a href="#">Completed</a>
              </li>
            </ul>
          </div>
          <div class="btn-group pull-right">
            <button class="btn btn-flat-gray dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span>New Goal</span>
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li>
                <a href="#" id='team-goal' data-toggle="modal" data-target="#new-goal">Team Goal</a>
              </li>
              <li class="disabled">
                <a href="#" id='personal-goal'>Personal Goal</a>
              </li>
            </ul>
          </div>
        </div>
        <div class="container-fluid goal-list">
          <div class="row">
            <div class="col-lg-4 col-md-6 pd-lr-11 mg-t-15">
              <img src="images/perform-demo/goal-general-performance.png" alt="General Performance" />
            </div>
            <div class="col-lg-4 col-md-6 pd-lr-11 mg-t-15">
              <img src="images/perform-demo/goal-launch-projectx.png" alt="Launch Project X" />
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="new-goal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button class="close" data-dismiss="modal" aria-label="Close">
            <span>Ã—</span>
          </button>
          <h4 class="modal-title pf-text-stronger">
            New goal
          </h4>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-sm-12">
              <div class="card-input pf-mar-top" id="js-input-title">
                <input class="js-goal-title" type="text" value="Launch Sales Campaign" tabindex="1" maxlength="50" disabled>
                <label>Title</label>
                <div class="card-character-count js-title-count">29 / 50</div>
              </div>
              <div class="js-text-editor">
                <div id="new-goal-desc-editor" class="card-input">
                  <input class="js-goal-title" type="text" value="Complete build sales compaign" tabindex="2" disabled>
                  <label>Description</label>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-flat-green js-btn-submit text-uppercase" tabindex="3">Save Changes</button>
        </div>
      </div>
    </div>
  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  <script src="js/global.js"></script>
  <script type="text/javascript">
    $(document).ready(function(e){
      var setViewedContent = function(content){
        var viewedContents = '';
        if (localStorage.getItem('viewed-content')){
          viewedContents = localStorage.getItem('viewed-content');
          if (viewedContents.split(';').indexOf(content) < 0) {
            viewedContents += content + ';';
          }
        } else {
          viewedContents += content + ';';
        }
        localStorage.setItem('viewed-content', viewedContents);
      },
      loadViewContents = function(){
        var viewedContents = localStorage.getItem('viewed-content');
        if (viewedContents !== null){
          viewedContents = viewedContents.split(';');
          $.each(viewedContents, function(i, content){
            if (content !== ''){
              var viewedItem = $('.vertical-menu a[href="#' + content + '"]').addClass('viewed');
              $('.vertical-menu a').not(viewedItem).addClass('not-viewed');
              viewedItem = $('nav ul li a[data-active-key="' + content + '"]').addClass('viewed');
              $('nav ul li a').not(viewedItem).addClass('not-viewed');
            }
          });
        }
      },
      initVerticalViewed = function() {
        viewedContents =  $('#vertical-menu').find('a.viewed');
        $.each(viewedContents, function(i, viewed){
          content = $(viewed).attr('href').replace('#', '');
          setViewedContent(content);
        });
      };
      initNavViewed = function() {
        viewedContents =  $('nav ul li').find('a.viewed');
        $.each(viewedContents, function(i, viewed){
          content = $(viewed).attr('data-active-key');
          setViewedContent(content);
        });
      };
      loadViewContents();
      initNavViewed();
      initVerticalViewed();
      $('#nav-panel-trigger').on('click', function(e){
        e.preventDefault();
        $('body').toggleClass('nav-panel-opened');
      });

      $('#vertical-menu').find('a').on('click', function(e){
        e.preventDefault();
        var content = $(this).attr('href').replace('#', '');
        if (content !== ''){
          $('#vertical-menu').find('a').removeClass('active');
          $(this).addClass('active viewed');
          setViewedContent(content);
          $('#nav-panel').find('li.active').addClass('passed').removeClass('active');

          var navItem = $('#nav-panel').find('a[href="#' + content + '"]');
          navItem.parent().addClass('active');
          var contentDom = $('.content.' + content);
          $('.main-content').find('.content').removeClass('active');
          contentDom.addClass('active'); 

          if (content === 'visualize'){
            $('#next-content').hide();
          } else {
            $('#next-content').show();
          }
        }
      });

      $('nav ul li').find('a').on('click', function(e){
        var content = $(this).attr('data-active-key');
        if (content !== ''){
          setViewedContent(content);
        }
      });

      $('.non-interactive').find('img').on('click', function(){
        var self = $(this);
        if (!self.hasClass('clicked')){
          self.closest('.container').addClass('clicked');        
          window.setTimeout(function(){
            $('.non-interactive').find('.container').removeClass('clicked');
          }, 5000);
        } 
      });

      $('#next-content').on('click', function(e){
        e.preventDefault();
        if ($('#nav-panel').find('.active').next().length > 0){
          var content = $('#nav-panel').find('.active').next().find('a').attr('href').replace('#','');
          $('#nav-panel').find('.active').removeClass('active').addClass('passed').next().addClass('active');
          $('#vertical-menu').find('a[href="#' + content + '"]').trigger('click');
          if (content === 'visualize'){
            $('#next-content').hide();
          }
        }
      });

      $(".dropdown-toggle").click(function() {
        $(this).parent().find(".dropdown-menu").toggle();
      });

      $("#team-goal").click(function() {
        $(this).parents('.dropdown-menu').toggle();
      });

      $(".js-btn-submit").click(function() {
        $('#new-goal').modal('hide');
        var new_goal = "<div class='col-lg-4 col-md-6 pd-lr-11 mg-t-15'>" +
              "<img class='sample-goal' src='images/perform-demo/goal-launch-sales-campaign.png' alt='Launch Sales Campaign' />" +
              "<img class='sample-goal' style='display:none;' src='images/perform-demo/goal-launch-sales-campaign-rated.png' alt='Launch Sales Campaign' />" +
              "</div>";
        $(".goal-list .row").append(new_goal);
      });
    });
  </script>
</body>
