<!DOCTYPE html>
<head>
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <meta name="viewport" content="maximum-scale=1,width=device-width,initial-scale=1,user-scalable=0"> 
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="css/perform-demo.css" />
</head>
<body class="nav-panel-opened">
  <div class="main-wrapper">
    <header>
      <div class="container">
        <div class="logo">
          <img src="https://www.tinypulse.com/hubfs/redesign_2016/engage_logo.png" />
        </div> 
      </div>
    </header> 
    <div class="content-wrapper">
      <nav>
        <ul class="nav" id="side-menu">
          <li class="active">
            <a href="#">
              <i class="icon icon-speed"></i> <span class="nav-label">Dashboard</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li>
            <a href="#">
              <i class="icon icon-goal"></i> <span class="nav-label">Goals</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li>
            <a href="#">
              <i class="icon icon-arrow-up"></i> <span class="nav-label">Rate</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li>
            <a href="#">
              <i class="icon icon-chrome"></i> <span class="nav-label">360</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li>
            <a href="#">
              <i class="icon icon-snapshot"></i> <span class="nav-label">Reporting</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li>
            <a href="#">
              <i class="icon icon-setting"></i> <span class="nav-label">Settings</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
          <li>
            <a href="#">
              <i class="icon icon-help-circled"></i> <span class="nav-label">Help Center</span>
              <p class="tooltip">Lorem ipsum dolor sit amet.</p>
            </a>
          </li>
        </ul>
      </nav>
      <div class="main-content">
        <div class="cols">
          <div class="col col-60">
            <div class="card no-style">
              <img src="https://www.tinypulse.com/hubfs/redesign_2016/tour-guide/perform/Overall.png" alt="overall" />
            </div>
          </div>
          <div class="col col-40">
            <div class="card no-style">
              <img src="https://www.tinypulse.com/hubfs/redesign_2016/tour-guide/perform/Manage_team.png" alt="overall" />
            </div>
            <div class="card flatten-card">
              <div class="card-title">Goals</div>
              <div class="card-hint">Only showing active</div>
              <div class="card-corner">
                <a class="pf-clickable" href="#">See all</a>
              </div>
              <div class="card-fill-content">
                <ul class="fill-horizontal nav nav-tabs" role="tablist">
                  <li class="js-team-goal-tab">
                    <a href="#team-goal" aria-controls="team-goal" role="tab" data-toggle="tab" aria-expanded="false">Team</a>
                  </li>
                  <li class="js-individual-goal-tab active">
                    <a href="#individual-goal" aria-controls="individual-goal" role="tab" data-toggle="tab" aria-expanded="true">Self</a>
                  </li>
                </ul>
                <div class="tab-content">
                  <div class="fade tab-pane" id="team-goal" role="tabpanel">
                    <div id="team-goal-list">
                      <div class="panel media-item">
                        <div class="media-header pf-clickable">
                          <div class="media-icon">
                            <div class="goal-icon icon-2x icon-members"></div>
                          </div>
                          <div class="media-header-content">
                            <div class="pf-text-semibold">General Performance</div>
                          </div>
                        </div>
                      </div>
                      <div class="panel media-item">
                        <div class="media-header pf-clickable">
                          <div class="media-icon">
                            <div class="goal-icon icon-2x icon-members"></div>
                          </div>
                          <div class="media-header-content">
                            <div class="pf-text-semibold">Launch Project X</div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="clearfix"></div>
                  </div>
                  <div class="fade tab-pane active in" id="individual-goal" role="tabpanel">
                    <div id="my-goal-list">
                      <div class="panel media-item">
                        <div class="media-header pf-clickable collapsed" data-toggle="collapse" data-target="#goal-15780" data-parent="#my-goal-list" aria-expanded="false">
                          <div class="media-icon">
                          </div>
                          <div class="media-header-content">
                            <div class="pf-text-semibold">General Performance</div>
                          </div>
                        </div>
                      </div>
                      <div class="panel media-item">
                        <div class="media-header pf-clickable collapsed" data-toggle="collapse" data-target="#goal-693" data-parent="#my-goal-list" aria-expanded="false">
                          <div class="media-icon">
                          </div>
                          <div class="media-header-content">
                            <div class="pf-text-semibold">Launch Sales Campaign</div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="clearfix"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>            
        </div>
      </div>
    </div>
  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  <script src="js/global.js"></script>
  <script type="text/javascript">
    $(document).ready(function(e){
      var setViewedContent = function(content){
        var viewedContents = '';
        if (localStorage.getItem('viewed-content')){
          viewedContents = localStorage.getItem('viewed-content');
          if (viewedContents.split(';').indexOf(content) < 0) {
            viewedContents += content + ';';
          }
        } else {
          viewedContents += content + ';';
        }
        localStorage.setItem('viewed-content', viewedContents);
      },
      loadViewContents = function(){
        var viewedContents = localStorage.getItem('viewed-content');
        if (viewedContents !== null){
          viewedContents = viewedContents.split(';');
          $.each(viewedContents, function(i, content){
            if (content !== ''){
              var viewedItem = $('.vertical-menu a[href="#' + content + '"]').addClass('viewed');
              $('.vertical-menu a').not(viewedItem).addClass('not-viewed');
              viewedItem = $('nav ul li a[data-active-key="' + content + '"]').addClass('viewed');
              $('nav ul li a').not(viewedItem).addClass('not-viewed');
            }
          });
        }
      },
      initVerticalViewed = function() {
        viewedContents =  $('#vertical-menu').find('a.viewed');
         $.each(viewedContents, function(i, viewed){
           content = $(viewed).attr('href').replace('#', '');
           setViewedContent(content);
         });
      };
      initNavViewed = function() {
        viewedContents =  $('nav ul li').find('a.viewed');
         $.each(viewedContents, function(i, viewed){
           content = $(viewed).attr('data-active-key');
           setViewedContent(content);
         });
      };
      loadViewContents();
      initNavViewed();
      initVerticalViewed();
      $('#nav-panel-trigger').on('click', function(e){
        e.preventDefault();
        $('body').toggleClass('nav-panel-opened');
      });

      $('#vertical-menu').find('a').on('click', function(e){
        e.preventDefault();
        var content = $(this).attr('href').replace('#', '');
        if (content !== ''){
          $('#vertical-menu').find('a').removeClass('active');
          $(this).addClass('active viewed');
          setViewedContent(content);
          $('#nav-panel').find('li.active').addClass('passed').removeClass('active');

          var navItem = $('#nav-panel').find('a[href="#' + content + '"]');
          navItem.parent().addClass('active');
          var contentDom = $('.content.' + content);
          $('.main-content').find('.content').removeClass('active');
          contentDom.addClass('active'); 

          if (content === 'visualize'){
            $('#next-content').hide();
          } else {
            $('#next-content').show();
          }
        }
      });

      $('nav ul li').find('a').on('click', function(e){
        var content = $(this).attr('data-active-key');
        if (content !== ''){
          setViewedContent(content);
        }
      });

      $('.non-interactive').find('img').on('click', function(){
        var self = $(this);
        if (!self.hasClass('clicked')){
          self.closest('.container').addClass('clicked');        
          window.setTimeout(function(){
            $('.non-interactive').find('.container').removeClass('clicked');
          }, 5000);
        } 
      });

      $('#next-content').on('click', function(e){
        e.preventDefault();
        if ($('#nav-panel').find('.active').next().length > 0){
          var content = $('#nav-panel').find('.active').next().find('a').attr('href').replace('#','');
          $('#nav-panel').find('.active').removeClass('active').addClass('passed').next().addClass('active');
          $('#vertical-menu').find('a[href="#' + content + '"]').trigger('click');
          if (content === 'visualize'){
            $('#next-content').hide();
          }
        }
      });
    });
  </script>
</body>
